<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block Blast</title>
    <script src="../Hidden/Script/cdn.tailwindcss.com.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    }
                }
            }
        };
    </script>
    <style>
        body {
            touch-action: manipulation;
            overscroll-behavior: none;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(var(--columns), 1fr);
            grid-template-rows: repeat(var(--rows), 1fr);
            gap: 2px;
            background-color: rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .dark .game-board {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .cell {
            aspect-ratio: 1/1;
            border-radius: 2px;
            transition: background-color 0.1s ease;
            position: relative;
        }

        /* Toggle Switch Styles */
        .toggle-bg {
            background-color: #ccc;
            position: relative;
            cursor: pointer;
        }

        .toggle-dot {
            position: absolute;
            top: 0;
            left: 0;
            width: 1.25rem;
            height: 1.25rem;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        #themeToggle:checked + .toggle-bg {
            background-color: #5D5CDE;
        }

        #themeToggle:checked + .toggle-bg .toggle-dot {
            transform: translateX(1.25rem);
        }

        /* Other CSS styles omitted for brevity */

    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 min-h-screen antialiased">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <!-- Theme Toggle -->
        <div class="flex justify-end mb-4">
            <label for="themeToggle" class="flex items-center cursor-pointer">
                <span class="mr-2 text-gray-800 dark:text-white">Light</span>
                <input type="checkbox" id="themeToggle" class="hidden">
                <div class="toggle-bg w-12 h-6 flex items-center rounded-full p-1">
                    <div class="toggle-dot"></div>
                </div>
                <span class="ml-2 text-gray-800 dark:text-white">Dark</span>
            </label>
        </div>

        <!-- Game Title -->
        <h1 class="text-3xl md:text-4xl font-bold text-center text-primary mb-6">Block Blast</h1>

        <!-- Game Container -->
        <div class="flex flex-col md:flex-row gap-6 items-start">
            <!-- Left Column - Game Board -->
            <div class="w-full md:w-2/3 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                <div id="gameBoard" class="game-board border-2 border-gray-200 dark:border-gray-700 w-full aspect-square"></div>
                
                <div class="mt-4 flex flex-col sm:flex-row justify-between items-center">
                    <div>
                        <button id="rotateButton" class="px-4 py-2 bg-primary text-white rounded-lg mr-2 hover:bg-opacity-90 transition">
                            Rotate
                        </button>
                        <button id="resetButton" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-opacity-90 transition">
                            Reset
                        </button>
                    </div>
                    <div id="mobileDragInfo" class="text-sm text-gray-500 dark:text-gray-400 mt-2 sm:mt-0">
                        Drag blocks to place them
                    </div>
                </div>
            </div>
            
            <!-- Right Column - Game Info and Next Pieces -->
            <div class="w-full md:w-1/3 flex flex-col gap-4">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                    <div class="flex justify-between items-center mb-3">
                        <div>
                            <h2 class="text-xl font-bold text-gray-800 dark:text-white">Score</h2>
                            <p id="scoreDisplay" class="text-3xl font-bold text-primary">0</p>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-gray-800 dark:text-white">Level</h2>
                            <p id="levelDisplay" class="text-3xl font-bold text-primary">1</p>
                        </div>
                    </div>
                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                        <div id="progressBar" class="bg-primary h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- Next Piece Preview -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">Next Block</h2>
                    <div id="nextPiece" class="next-piece-container mx-auto" style="max-width: 70px; max-height: 70px;"></div>
                </div>
                
                <!-- Instructions -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-2">How to Play</h2>
                    <ul class="text-sm text-gray-600 dark:text-gray-300 space-y-2">
                        <li>• Drag blocks to the board</li>
                        <li>• Tap or click "Rotate" to rotate blocks</li>
                        <li>• Fill complete rows or columns to clear them</li>
                        <li>• Clear multiple lines at once for bonus points</li>
                        <li>• Game ends when no more blocks can be placed</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Game Over Modal -->
        <div id="gameOverModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 mx-4 max-w-md w-full transform transition-all">
                <h2 class="text-2xl font-bold text-center text-red-500 mb-4">Game Over!</h2>
                <p class="text-gray-700 dark:text-gray-300 text-center mb-2">No more moves available.</p>
                <p class="text-xl font-bold text-center text-primary mb-6">Final Score: <span id="finalScore">0</span></p>
                
                <div class="flex flex-col sm:flex-row gap-3 justify-center">
                    <button id="newGameButton" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-opacity-90 transition">
                        New Game
                    </button>
                    <button id="shareScoreButton" class="px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-opacity-90 transition">
                        Share Score
                    </button>
                </div>
            </div>
        </div>
        
        <script>
            const themeToggle = document.getElementById('themeToggle');

            themeToggle.addEventListener('change', () => {
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
            });

            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.classList.toggle('dark', savedTheme === 'dark');
                themeToggle.checked = savedTheme === 'dark';
            }

            // Other game initialization and logic scripts go here...
        </script>
    </div>
</body>
</html>
